# 子プロジェクト用勤怠管理システム セットアップガイド

## 概要

この子プロジェクトは、メインの勤怠管理システムから独立して動作する個人用の勤怠管理スプレッドシートです。認証はメインスプレッドシートのメンバーリストを参照し、勤怠データは各個人のスプレッドシートに保存されます。

## 初回セットアップ手順

### 1. スプレッドシートのコピー

1. メインの勤怠管理スプレッドシートから、この子プロジェクト用スプレッドシートをコピーします
2. 適切な名前に変更します（例：「田中太郎\_勤怠管理」）

### 2. 初回セットアップの実行

1. スプレッドシートを開きます
2. メニューバーに「シート作成メニュー」が表示されるまで少し待ちます
3. 「シート作成メニュー」→「初回セットアップ」をクリックします
4. 認証用スプレッドシートIDの入力画面が表示されます

### 3. 認証用スプレッドシートIDの設定

1. メインの勤怠管理スプレッドシート（メンバーリストがあるスプレッドシート）のURLを開きます
2. URLから以下の部分をコピーします：
   ```
   https://docs.google.com/spreadsheets/d/【この部分をコピー】/edit
   ```
3. コピーしたIDを入力画面に貼り付けます
4. 「OK」をクリックします

### 4. セットアップ完了の確認

- 「セットアップ完了」のメッセージが表示されれば成功です
- メニューに「認証設定確認」が追加されます

## 使用方法

### ログイン

1. Webアプリケーション（フロントエンド）からアクセスします
2. メインスプレッドシートに登録されている名前とパスワードでログインします
3. 認証が成功すると、個人用スプレッドシートに勤怠データが保存されます

### 勤怠データの管理

- 勤怠データは「YYYY年MM月\_ユーザーID」形式のシート名で自動作成されます
- 各月ごとに別々のシートで管理されます
- データの修正や確認は直接スプレッドシート上でも可能です

## トラブルシューティング

### 認証エラーが発生する場合

1. 「シート作成メニュー」→「認証設定確認」で設定を確認します
2. スプレッドシートIDが正しく設定されているか確認します
3. メインスプレッドシートにアクセス権限があるか確認します

### メニューが表示されない場合

1. スプレッドシートを再読み込みします
2. 「初回セットアップ」を再実行します

### ログインできない場合

1. 名前とパスワードがメインスプレッドシートの「メンバーリスト」に正しく登録されているか確認します
2. 認証用スプレッドシートIDが正しく設定されているか確認します
3. メインスプレッドシートへのアクセス権限があるか確認します

## 技術仕様

### ファイル構成

- `ChildScript.gs`: 子プロジェクト用のメイン機能
- `Auth_Child.gs`: 子プロジェクト用認証機能
- `Code_Child.gs`: 子プロジェクト用APIエンドポイント
- `memberRegistration.html`: メンバー登録用HTMLダイアログ

### 認証フロー

1. ユーザーがログイン情報を入力
2. 設定されたメインスプレッドシートの「メンバーリスト」で認証
3. 認証成功時、現在のスプレッドシートIDを返却
4. 勤怠データは現在のスプレッドシートに保存

### データ保存形式

各月のシートには以下の列が含まれます：

- 日付
- 出勤時刻
- 退勤時刻
- 休憩時間
- 勤務時間
- 勤務場所
- 備考
- 更新日時

## サポート

問題が解決しない場合は、システム管理者にお問い合わせください。
