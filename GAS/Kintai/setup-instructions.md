# GAS勤怠管理システム セットアップ手順書

## 概要

このドキュメントは、GAS（Google Apps Script）を使用した勤怠管理システムのセットアップ手順を説明します。

## 新しいユーザー向けセットアップ手順

### 1. スプレッドシートのコピー

1. 元のスプレッドシートを開く
2. 「ファイル」→「コピーを作成」を選択
3. 適切な名前を付けて保存

### 2. 初回セットアップの実行

1. コピーしたスプレッドシートを開く
2. 上部メニューに「シート作成メニュー」が表示されない場合は、以下の手順を実行：
   - 「拡張機能」→「Apps Script」を開く
   - スクリプトエディタで「setupForNewUser」関数を見つける
   - 関数名の左にある「実行」ボタンをクリック
   - 権限の承認を求められた場合は、指示に従って承認

### 3. 権限の承認

初回実行時に以下の権限承認が必要です：

- **スプレッドシートの表示と編集**：メンバー情報の管理に必要
- **Googleドライブのファイル作成**：個人用勤怠シートの作成に必要
- **外部サービスへの接続**：メール送信機能（将来的な機能拡張用）

### 4. セットアップ完了の確認

- 上部メニューに「シート作成メニュー」が表示される
- メニューから以下の機能が利用可能：
  - メンバー登録
  - 2025年データを集計
  - パスワードリセット
  - 初回セットアップ

## 主要機能の説明

### メンバー登録機能

- 新しいメンバーの情報を登録
- 自動的にパスワードを生成
- **実行者のGoogleドライブ**に個人用勤怠シートを作成
- メールアドレスは任意入力（必須ではない）

### パスワードリセット機能

- 既存メンバーのパスワードをリセット
- メールアドレスでユーザーを検索
- 新しいパスワードを自動生成

### データ集計機能

- 各メンバーの個人用勤怠シートからデータを統合
- 2025年のデータを自動集計

## 重要な注意事項

### セキュリティ

- 生成されたパスワードは安全に管理してください
- スプレッドシートの共有設定に注意してください
- 個人情報の取り扱いには十分注意してください

### ファイル作成について

- 個人用勤怠シートは**メンバー登録を実行したユーザーのGoogleドライブ**に作成されます
- 作成されたファイルは「リンクを知っている人は編集可能」に設定されます
- ファイルの所有者は実行者となります

### トラブルシューティング

#### メニューが表示されない場合

1. ブラウザを更新してスプレッドシートを再読み込み
2. 「初回セットアップ」を再実行
3. 権限が正しく承認されているか確認

#### 個人用シート作成に失敗する場合

1. Googleドライブの容量を確認
2. 権限が正しく承認されているか確認
3. テンプレートシート（現在の年のシートまたは「データ」シート）が存在するか確認

#### 権限エラーが発生する場合

1. 「拡張機能」→「Apps Script」を開く
2. 「承認が必要」と表示された場合は、指示に従って承認
3. 必要に応じてGoogleアカウントの管理者に相談

## 配布方法の推奨事項

### テンプレートとしての配布

1. マスタースプレッドシートを作成
2. 必要なシート（メンバーリスト、データシートなど）を準備
3. セットアップ手順書を添付
4. ユーザーにコピー作成を依頼

### 組織内での展開

1. 管理者がマスターテンプレートを作成
2. 各部署・チームがコピーを作成
3. 各チームの管理者が初回セットアップを実行
4. メンバー登録は各チームで実施

## サポート

問題が発生した場合は、以下の情報を含めてサポートに連絡してください：

- 発生した問題の詳細
- エラーメッセージ（あれば）
- 実行した手順
- 使用しているブラウザとバージョン

---

**最終更新日**: 2025年1月
**バージョン**: 1.0
